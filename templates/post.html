{% extends 'base.html' %}
{% load static %}
{% block main %}
<main>
    <div class="homePage">
        <div class="postClass" id="postID">
            {% for post in books %}
                <iframe src="{% static 'pdfjs/web/viewer.html' %}?file={{ post.pdf.url }}" width="100%" height="800px" id="pdfIframe"></iframe>
            {% endfor %}
        </div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
        <script>
            // PC Version: Detecting key press (Print Screen button)
            window.addEventListener("keyup", function(e) {
                if (e.keyCode === 44) { // Key code for Print Screen button
                    document.getElementById('pdfIframe').style.display = 'none'; // Hide iframe
                    document.getElementById('postID').textContent = 'Копирование запрещено, обновите страницу и попробуйте снова. Все права защищены.';
                }
            });

            // Mobile Version: Detecting touch gestures with Hammer.js
            var postElement = document.getElementById('postID');
            var pdfIframe = document.getElementById('pdfIframe');
            var hammer = new Hammer(postElement);

            // Hide iframe on long press (to simulate screenshot)
            hammer.on('press', function() {
                pdfIframe.style.display = 'none'; // Hide iframe on long press
                postElement.textContent = 'Копирование запрещено, обновите страницу и попробуйте снова. Все права защищены.';
            });

            // Hide iframe on double-tap gesture (as another form of user interaction)
            hammer.on('doubletap', function() {
                pdfIframe.style.display = 'none'; // Hide iframe on double-tap
                postElement.textContent = 'Копирование запрещено, обновите страницу и попробуйте снова. Все права защищены.';
            });

            // Hide iframe on touchstart event to simulate screenshot attempt
            postElement.addEventListener('touchstart', function() {
                pdfIframe.style.display = 'none'; // Hide iframe when screen is touched
                postElement.textContent = 'Копирование запрещено, обновите страницу и попробуйте снова. Все права защищены.';
            });
        </script>
    </div>
</main>
{% endblock %}
